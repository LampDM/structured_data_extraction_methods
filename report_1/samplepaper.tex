
\documentclass[runningheads]{llncs}
\usepackage{graphicx}
\usepackage{apacite}
\usepackage{float}
\usepackage{listings}
\usepackage{float}
\usepackage[table]{xcolor}
\begin{document}

\title{Programming Assignment 2}
\subtitle{Implementing structured data extraction}

\author{
  Jaka Kokošar
  \and
  Danijel Maraž
  \and
  Toni Kocjan
}


\institute{Fakulteta za Računalništvo in Informatiko UL
\email{dm9929@student.uni-lj.si}\\
}

\maketitle             

\begin{abstract}
The article covers the work done in the scope of the second programming assignment as part of the subject web information extraction and retrieval. 

\keywords{Data Extraction Retrieval XPath Regex Roadrunner }
\end{abstract}

\section{Introduction}
After having collected the raw data with a crawler the logical next step is to convert it into a more structured format. As web pages do not have a strict shape this poses quite a challenge as any attempt of data extraction must be robust and resistant to various deformities in the html code. The report covers our attempts in implementing processes of structured data extraction in 6 different pages using basic methods such as regular expressions and xpath expressions. Alongside this an attempt was made to implement the RoadRunner algorithm which greatly simplifies the unpredictability aspect of data extraction.
\section{Description of chosen web pages and data items}
\section{Regular expressions implementation}
\subsection{jewelry}
\subsubsection{output1}
\subsubsection{output2}
\subsection{cars}
\subsubsection{output1}
\subsubsection{output2}
\subsection{koce}
\subsubsection{output1}
\subsubsection{output2}
\section{XPath implementation}

\subsection{jewelry}
An initial Xpath expression is called on the input html which selects a \textit{tbody} element. The children of this element represent our jewelry and other items on the page. We count the number of children and with a for loop and extra Xpath expression access each data item that interests us for each child. Any children that are malformed or do not contain the items we're interested in (such as price etc.) encounter an exception as the Xpath expression throws an error and are automatically not processed. Afterwards some minor post-processing of the acquired strings is done and the json is created.
\subsubsection{Output}
 1
\begin{lstlisting}
{
    "title": "10-kt. Seven Diamond Ladies Heart Ring (0.08 TW)",
    "content": "This ladies fashion ring dazzles\nwith hearts and diamonds. The gold band is crafted into delicate, open hearts.\nSeven brilliant-cut diamonds add a bit of sparkle. ",
    "listprice": "$149.00",
    "price": "$69.99",
    "saving": "$79.01",
    "savprcnt": "(53%)"
}
{
    "title": "10-Kt. Diamond Ring (.25 TW)",
    "content": "Nineteen round diamonds accent this 10-karat yellow gold ring with filigree accents.",
    "listprice": "$250.00",
    "price": "$74.90",
    "saving": "$175.10",
    "savprcnt": "(70%)"
}
{
    "title": "10-kt. Pearl and Diamond Butterfly Earrings",
    "content": "Perfectly proportioned 5.5- to\n6-mm cultured pearls on 10-karat yellow gold settings highlight these petite\nearrings. A dainty rhodium-plated gold butterfly studded with a diamond (0.02\ntotal carat weight, J-K color, I-2 clarity) rests atop each pearl.",
    "listprice": "$149.00",
    "price": "$42.99",
    "saving": "$106.01",
    "savprcnt": "(71%)"
}
{
    "title": "14-kt. Diamond 'S' Tennis Bracelet (2.00 TW)",
    "content": "Invest in a swirl of light with\nthis diamond 'S' tennis bracelet. Crafted in 14-karat gold, the piece features\n49 diamonds for two full carats. The 7.25-inch bracelet closes with a pressure\nclasp.",
    "listprice": "$1,539.99",
    "price": "$499.99",
    "saving": "$1,040.00",
    "savprcnt": "(67%)"
}
{
    "title": "10-kt. Diamond Band Fashion Ring (.11 TW)",
    "content": "Crafted in white and yellow gold,\nthis ring displays a band of seven round diamonds. Order your new gold and\ndiamond fashion ring today at our low, online price.",
    "listprice": "$179.99",
    "price": "$79.99",
    "saving": "$100.00",
    "savprcnt": "(55%)"
}
{
    "title": "14-kt. White Gold, Pearl and Diamond Ring",
    "content": "Show your romantic side with this\n14-karat diamond and pearl ring. Set in a domed band of 14-karat white gold,\nthe ring features a 7-mm cultured pearl. Curved rows of diamonds flank the\npearl.",
    "listprice": "$419.99",
    "price": "$149.99",
    "saving": "$270.00",
    "savprcnt": "(64%)"
}
{
    "title": "14-kt. Gold Diamond Present Future Pendant (.25TW)",
    "content": "Designed with three large, sparkling\ndiamonds to represent past, present, and future, this stunning pendant is\nset in gleaming 14-karat gold. It incorporates a total of nine diamonds (0.25\ntotal carat weight, K color, I-2 to I-3 clarity).  ",
    "listprice": "$299.00",
    "price": "$149.99",
    "saving": "$149.01",
    "savprcnt": "(49%)"
}
{
    "title": "14-kt. Diamond Solitaire Pendant (.33 TW)",
    "content": "In this simple, yet elegant pendant,\na round brilliant diamond (0.33 total carat weight, H-J color, I-1 to I-2\nclarity) is prong-set in 14-karat white gold.",
    "listprice": "$1,019.99",
    "price": "$319.99",
    "saving": "$700.00",
    "savprcnt": "(68%)"
}
{
    "title": "14-kt. Diamond Solitaire Earrings (0.33 TW)",
    "content": "Dazzle your way into her heart,\nwith these classic diamond solitaire earrings. Two brilliant-cut diamonds\n(0.33 total carat weight, G-H color, I-1 to I-2 clarity) are set in four\nprongs of 14-karat white gold.",
    "listprice": "$639.99",
    "price": "$199.99",
    "saving": "$440.00",
    "savprcnt": "(68%)"
}
{
    "title": "14-kt. Diamond Cross Pendant (.06 TW)",
    "content": "Over a cleanly sculpted Roman\ncross of 14-karat white gold drapes a slender banner containing three bright\nprong-set round diamonds (0.06 total carat weight, H-I color, I clarity).",
    "listprice": "$305.00",
    "price": "$119.99",
    "saving": "$185.01",
    "savprcnt": "(60%)"
}
{
    "title": "14-kt. Diamond Solitaire Stud Earrings (.50 TW)",
    "content": "Every jewelry collection needs\na classic pair of diamond solitaire earrings. Set in 14-karat gold, these\ndiamond stud earrings (0.50 total carat weight) have post backs with butterfly\nclasps.",
    "listprice": "$999.99",
    "price": "$359.99",
    "saving": "$640.00",
    "savprcnt": "(64%)"
}
{
    "title": "14-kt. Cultured Pearl Diamond Earrings",
    "content": "Create an elegant appearance with\nthese pearl and diamond stud earrings. Set in 14-karat yellow gold, each\nearring features an 8 to 8.5-mm cultured white pearl. Prong-set round diamonds\naccent the pearls. Posts with butterfly clasps secure the earrings.",
    "listprice": "$508.99",
    "price": "$179.99",
    "saving": "$329.00",
    "savprcnt": "(64%)"
}
{
    "title": "14-kt. Diamond 7.5-8 mm Pearl Pendant",
    "content": "Add a classic to your jewelry\ncollection with this 14-karat gold, diamond, and pearl necklace. The 7.5-8\nmm cultured white pearl creates the focal point of the pendant, while a diamond\n(0.10 TW) adds sparkle.",
    "listprice": "$196.99",
    "price": "$69.99",
    "saving": "$127.00",
    "savprcnt": "(64%)"
}
{
    "title": "14-kt. Diamond Solitaire Earrings (.50 TW)",
    "content": "This earring set has two brilliant-cut\ndiamonds (0.50 total carat weight, G-H color, I-1 to I-2 clarity) set in\nfour prongs of 14-karat white gold.",
    "listprice": "$1,369.99",
    "price": "$409.99",
    "saving": "$960.00",
    "savprcnt": "(70%)"
}
{
    "title": "14-kt White Gold Diamond Band (0.50 TW)",
    "content": "Crafted of 14-karat white gold,\nthis stylish ring features a bright row of 20 channel-set, princess-cut baguette\ndiamonds. Treat her like royalty and save when you buy jewelry treasures\nat Overstock.com.",
    "listprice": "$1,635.00",
    "price": "$609.99",
    "saving": "$1,025.01",
    "savprcnt": "(62%)"
}
\end{lstlisting}
\subsubsection{Output}
 2
\begin{lstlisting}
{
    "title": "14-kt. Green Jade Hoops",
    "content": "Hoops of cool green jade rest\nbetween 14-karat yellow gold endpieces. The hoops graduate in thickness from\n3 mm at the ends to 6 mm in the center, with approximately 29 mm overall\ndiameter.",
    "listprice": "$90.00",
    "price": "$46.99",
    "saving": "$43.01",
    "savprcnt": "(47%)"
}
{
    "title": "14-kt. Jade Doughnut Pendant",
    "content": "The 25-mm disk hangs delicately\nfrom a 14-karat gold chain. The disk features a dramatic gold Chinese character\nin the center, accompanied by four stylized gold bees.",
    "listprice": "$150.00",
    "price": "$48.99",
    "saving": "$101.01",
    "savprcnt": "(67%)"
}
{
    "title": "14-kt. Charcoal Jade and Ruby Elephant Pendant",
    "content": "Carved of rich dark grey jade,\nthis elephant pendant has 14-karat yellow gold applied to mark the feet,\ntusk, tail, and blanket. A 2-mm round faceted ruby in a gold bezel setting\nforms the eye. The pendant hangs from an 18-inch chain.",
    "listprice": "$100.00",
    "price": "$28.99",
    "saving": "$71.01",
    "savprcnt": "(71%)"
}
{
    "title": "14-kt. Carved Lavender Jade Earrings",
    "content": "Luscious 8-mm lavender jade balls, carved with intricate Asian style, dangle from a 14-karat yellow gold French hook.",
    "listprice": "$80.00",
    "price": "$39.99",
    "saving": "$40.01",
    "savprcnt": "(50%)"
}
{
    "title": "14-kt. Jade Cross Pendant",
    "content": "Green jade and gold create this\nbeautiful cross pendant. Cylindrical bars of green jade feature caps and\ncenter of 14-karat yellow gold.",
    "listprice": "$150.00",
    "price": "$49.99",
    "saving": "$100.01",
    "savprcnt": "(66%)"
}
{
    "title": "14-kt. Multicolored Jade Earrings",
    "content": "A delicate wrapping of 14-karat\nyellow gold wire holds six 6 x 4 pear shapes of jade in various shades: brilliant\ngreen, orange, lavender, black, pale yellow, and white. The post earrings\nhave butterfly backs.",
    "listprice": "$375.00",
    "price": "$99.99",
    "saving": "$275.01",
    "savprcnt": "(73%)"
}
{
    "title": "14-kt. Multicolored Jade Ring",
    "content": "A delicate wrapping of 14-karat\nyellow gold wire holds six 6 x 4 ovals of jade in various shades: brilliant\ngreen, orange, lavender, black, pale yellow, and white. A narrow gold band\ndivides to support the setting.",
    "listprice": "$250.00",
    "price": "$56.99",
    "saving": "$193.01",
    "savprcnt": "(77%)"
}
{
    "title": "14-kt. Onyx and Ruby Elephant Pendant",
    "content": "Carved of rich black onyx, this\nelephant pendant has 14-karat yellow gold applied to mark the feet, tusk,\ntail, and blanket. A 2-mm round faceted ruby in a gold bezel setting forms\nthe eye. The pendant hangs from an 18-inch chain.",
    "listprice": "$100.00",
    "price": "$35.99",
    "saving": "$64.01",
    "savprcnt": "(64%)"
}
\end{lstlisting}
\subsection{cars}
The items Title, SubTitle, Author, PublishedTime and Lead are all collected via seperate XPath expressions on the input html as both pages have the same structure when it comes to them. The main difference between the two pages is the structure of the article body from which we've derived our Content item. We handle this by first extracting an article body tag which contains all the contents we need. Afterwards we give the extracted element as an argument to our function \textit{intr} which recursively iterates through the tag structure and appends all encountered text into a \textit{nonlocal} string. The string is then briefly processed and added to our json output.
\subsubsection{output1}
\subsubsection{output2}
\subsection{koce}
\subsubsection{output1}
\subsubsection{output2}
\section{RoadRunner like implementation}
\begin{lstlisting}
import numpy as np
 
def incmatrix(genl1,genl2):
    m = len(genl1)
    n = len(genl2)
    M = None #to become the incidence matrix
    VT = np.zeros((n*m,1), int)  #dummy variable
 
    #compute the bitwise xor matrix
    M1 = bitxormatrix(genl1)
    M2 = np.triu(bitxormatrix(genl2),1) 
 
    for i in range(m-1):
        for j in range(i+1, m):
            [r,c] = np.where(M2 == M1[i,j])
            for k in range(len(r)):
                VT[(i)*n + r[k]] = 1;
                VT[(i)*n + c[k]] = 1;
                VT[(j)*n + r[k]] = 1;
                VT[(j)*n + c[k]] = 1;
 
                if M is None:
                    M = np.copy(VT)
                else:
                    M = np.concatenate((M, VT), 1)
 
                VT = np.zeros((n*m,1), int)
 
    return M
\end{lstlisting}


 \bibliographystyle{apacite}
 \bibliography{references}


\end{document}
